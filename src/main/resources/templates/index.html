<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Title</title>
    <link rel="stylesheet" href="css/index.css" />
  </head>
  <body>
    <div class="wrapper">
      <div class="chess-menu">
        <div class="chess-games"></div>
        <div class="chess-create">
          <div class="chess-create-submit">방 만들기</div>
        </div>
      </div>
    </div>
    <script>
      const templateGame = (id) =>
        `<a href="/game/${id}" class="chess-game"><div class="chess-game-title">체스 게임 ${id}</div></a>`;

      const chessGamesElement = document.querySelector('.chess-games');
      const chessCreateElement = document.querySelector('.chess-create');

      chessCreateElement.onclick = () => {
        fetch('/create', {
          method: 'POST',
        })
          .then((response) => response.json())
          .then((data) => {
            if (data.statusCode == 1) {
              location.replace('/game/' + data.dto);
            }
          });
      };

      fetch('http://localhost:4567/games')
        .then((response) => response.json())
        .then((data) => drawGameList(data.dto));

      function drawGameList(games) {
        games.forEach(
          (id) => (chessGamesElement.innerHTML += templateGame(id))
        );
      }
    </script>
  </body>
</html>
